<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Annotations &#8212; Princeton Geniza Project 4.17.3 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=12dfc556" />
    <script src="../_static/documentation_options.js?v=2b5c064c"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Developer Instructions" href="../devnotes.html" />
    <link rel="prev" title="Wagtail pages" href="pages.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="annotations">
<h1>Annotations<a class="headerlink" href="#annotations" title="Link to this heading">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<p id="module-geniza.annotations"><a class="reference internal" href="#module-geniza.annotations" title="geniza.annotations"><code class="xref py py-mod docutils literal notranslate"><span class="pre">geniza.annotations</span></code></a> provides a minimal implementation of the
W3C annotation protocol to provide annotation storage for
project transcriptions.</p>
<section id="module-geniza.annotations.models">
<span id="models"></span><h2>models<a class="headerlink" href="#module-geniza.annotations.models" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="geniza.annotations.models.Annotation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">geniza.annotations.models.</span></span><span class="sig-name descname"><span class="pre">Annotation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geniza/annotations/models.html#Annotation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geniza.annotations.models.Annotation" title="Link to this definition">¶</a></dt>
<dd><p>Annotation model for storing annotations in the database.</p>
<p>Annotations may be either block-level or line-level. Block-level annotation is the default;
in most cases, a block-level annotation’s content is stored as a TextualBody in its <cite>content</cite>
JSON.</p>
<p>However, block-level annotations may also be used to group line-level annotations, in which case
they have no textual content themselves, except for an optional label. Instead, their content
is serialized by joining TextualBody values from all associated line-level annotations.</p>
<p>Line-level annotations are associated with blocks via the <cite>block</cite> property, and that relationship
is serialized as <cite>partOf</cite> at the root of the line-level annotation.</p>
<dl class="py exception">
<dt class="sig sig-object py" id="geniza.annotations.models.Annotation.DoesNotExist">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">DoesNotExist</span></span><a class="headerlink" href="#geniza.annotations.models.Annotation.DoesNotExist" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="geniza.annotations.models.Annotation.MultipleObjectsReturned">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">MultipleObjectsReturned</span></span><a class="headerlink" href="#geniza.annotations.models.Annotation.MultipleObjectsReturned" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geniza.annotations.models.Annotation.block">
<span class="sig-name descname"><span class="pre">block</span></span><a class="headerlink" href="#geniza.annotations.models.Annotation.block" title="Link to this definition">¶</a></dt>
<dd><p>block-level annotation associated with this (line-level) annotation. if null, this is a
block-level annotation. if a block is deleted, all associated lines will be deleted.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="geniza.annotations.models.Annotation.block_content_html">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">block_content_html</span></span><a class="headerlink" href="#geniza.annotations.models.Annotation.block_content_html" title="Link to this definition">¶</a></dt>
<dd><p>convenience method to get HTML content, including label and any associated lines,
of a block-level annotation, as a list of HTML strings</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="geniza.annotations.models.Annotation.body_content">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">body_content</span></span><a class="headerlink" href="#geniza.annotations.models.Annotation.body_content" title="Link to this definition">¶</a></dt>
<dd><p>convenience method to get annotation body content</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geniza.annotations.models.Annotation.canonical">
<span class="sig-name descname"><span class="pre">canonical</span></span><a class="headerlink" href="#geniza.annotations.models.Annotation.canonical" title="Link to this definition">¶</a></dt>
<dd><p>optional canonical identifier, for annotations imported from another source</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geniza.annotations.models.Annotation.compile">
<span class="sig-name descname"><span class="pre">compile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">include_context</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geniza/annotations/models.html#Annotation.compile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geniza.annotations.models.Annotation.compile" title="Link to this definition">¶</a></dt>
<dd><p>Combine annotation data and return as a dictionary that
can be serialized as JSON.  Includes context by default,
but may be omitted when annotation will be included in context
that already has it defined.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geniza.annotations.models.Annotation.content">
<span class="sig-name descname"><span class="pre">content</span></span><a class="headerlink" href="#geniza.annotations.models.Annotation.content" title="Link to this definition">¶</a></dt>
<dd><p>json content of the annotation. in addition to W3C Web Annotation Data Model properties,
may also include: “schema:position”, which tracks the order of the annotation with respect
to others in the same block or canvas; and “textGranularity”, which indicates whether this
is a block- or line-level annotation</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geniza.annotations.models.Annotation.created">
<span class="sig-name descname"><span class="pre">created</span></span><a class="headerlink" href="#geniza.annotations.models.Annotation.created" title="Link to this definition">¶</a></dt>
<dd><p>date created</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="geniza.annotations.models.Annotation.etag">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">etag</span></span><a class="headerlink" href="#geniza.annotations.models.Annotation.etag" title="Link to this definition">¶</a></dt>
<dd><p>Compute and return an md5 hash of content to use as an ETag.</p>
<p>NOTE: Only <a class="reference internal" href="#geniza.annotations.models.Annotation.content" title="geniza.annotations.models.Annotation.content"><code class="xref py py-attr docutils literal notranslate"><span class="pre">content</span></code></a> can be modified in the editor, so it is the only hashed
attribute. If other attributes become mutable, modify this function to include them in
the ETag computation.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geniza.annotations.models.Annotation.footnote">
<span class="sig-name descname"><span class="pre">footnote</span></span><a class="headerlink" href="#geniza.annotations.models.Annotation.footnote" title="Link to this definition">¶</a></dt>
<dd><p>related scholarship record; used for source and manifest uri in JSON serialization</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geniza.annotations.models.Annotation.get_absolute_url">
<span class="sig-name descname"><span class="pre">get_absolute_url</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geniza/annotations/models.html#Annotation.get_absolute_url"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geniza.annotations.models.Annotation.get_absolute_url" title="Link to this definition">¶</a></dt>
<dd><p>url for this annotation (relative to the current application)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="geniza.annotations.models.Annotation.has_lines">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">has_lines</span></span><a class="headerlink" href="#geniza.annotations.models.Annotation.has_lines" title="Link to this definition">¶</a></dt>
<dd><p>cached property to indicate whether or not this is a block-level
annotation with line-level children</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geniza.annotations.models.Annotation.id">
<span class="sig-name descname"><span class="pre">id</span></span><a class="headerlink" href="#geniza.annotations.models.Annotation.id" title="Link to this definition">¶</a></dt>
<dd><p>annotation id (uuid, autogenerated when created)</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="geniza.annotations.models.Annotation.label">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">label</span></span><a class="headerlink" href="#geniza.annotations.models.Annotation.label" title="Link to this definition">¶</a></dt>
<dd><p>convenience method to get annotation label</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geniza.annotations.models.Annotation.modified">
<span class="sig-name descname"><span class="pre">modified</span></span><a class="headerlink" href="#geniza.annotations.models.Annotation.modified" title="Link to this definition">¶</a></dt>
<dd><p>date last modified</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geniza.annotations.models.Annotation.sanitize_html">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">sanitize_html</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">html</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geniza/annotations/models.html#Annotation.sanitize_html"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geniza.annotations.models.Annotation.sanitize_html" title="Link to this definition">¶</a></dt>
<dd><p>Sanitizes passed HTML according to allowed tags and attributes, stripping out any
that are not allowed, and spans with no attributes.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geniza.annotations.models.Annotation.set_content">
<span class="sig-name descname"><span class="pre">set_content</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geniza/annotations/models.html#Annotation.set_content"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geniza.annotations.models.Annotation.set_content" title="Link to this definition">¶</a></dt>
<dd><p>Set or update annotation content and model fields.</p>
<p>If <a class="reference internal" href="#geniza.annotations.models.Annotation.via" title="geniza.annotations.models.Annotation.via"><code class="xref py py-attr docutils literal notranslate"><span class="pre">via</span></code></a> or <a class="reference internal" href="#geniza.annotations.models.Annotation.canonical" title="geniza.annotations.models.Annotation.canonical"><code class="xref py py-attr docutils literal notranslate"><span class="pre">canonical</span></code></a> are set and the values
differ in the new data, a <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ValueError</span></code></a> exception will be raised
and the data will not be saved.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="geniza.annotations.models.Annotation.target_source_id">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">target_source_id</span></span><a class="headerlink" href="#geniza.annotations.models.Annotation.target_source_id" title="Link to this definition">¶</a></dt>
<dd><p>convenience method to access target source id</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="geniza.annotations.models.Annotation.target_source_manifest_id">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">target_source_manifest_id</span></span><a class="headerlink" href="#geniza.annotations.models.Annotation.target_source_manifest_id" title="Link to this definition">¶</a></dt>
<dd><p>convenience method to access manifest id for target source</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geniza.annotations.models.Annotation.uri">
<span class="sig-name descname"><span class="pre">uri</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geniza/annotations/models.html#Annotation.uri"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geniza.annotations.models.Annotation.uri" title="Link to this definition">¶</a></dt>
<dd><p>URI for this annotation (absolute url)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geniza.annotations.models.Annotation.via">
<span class="sig-name descname"><span class="pre">via</span></span><a class="headerlink" href="#geniza.annotations.models.Annotation.via" title="Link to this definition">¶</a></dt>
<dd><p>uri of annotation when imported from another copy (optional)</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="geniza.annotations.models.AnnotationQuerySet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">geniza.annotations.models.</span></span><span class="sig-name descname"><span class="pre">AnnotationQuerySet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">query</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">using</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geniza/annotations/models.html#AnnotationQuerySet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geniza.annotations.models.AnnotationQuerySet" title="Link to this definition">¶</a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="geniza.annotations.models.AnnotationQuerySet.by_target_context">
<span class="sig-name descname"><span class="pre">by_target_context</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">uri</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geniza/annotations/models.html#AnnotationQuerySet.by_target_context"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geniza.annotations.models.AnnotationQuerySet.by_target_context" title="Link to this definition">¶</a></dt>
<dd><p>filter queryset by the context of the target (i.e, the manifest
the canvas belongs to)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geniza.annotations.models.AnnotationQuerySet.group_by_canvas">
<span class="sig-name descname"><span class="pre">group_by_canvas</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geniza/annotations/models.html#AnnotationQuerySet.group_by_canvas"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geniza.annotations.models.AnnotationQuerySet.group_by_canvas" title="Link to this definition">¶</a></dt>
<dd><p>Aggregate annotations by canvas id; returns a dictionary of lists,
keys are canvas ids, items are lists of annotations.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geniza.annotations.models.AnnotationQuerySet.group_by_manifest">
<span class="sig-name descname"><span class="pre">group_by_manifest</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geniza/annotations/models.html#AnnotationQuerySet.group_by_manifest"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geniza.annotations.models.AnnotationQuerySet.group_by_manifest" title="Link to this definition">¶</a></dt>
<dd><p>Aggregate annotations by manifest uri; returns a dictionary of lists,
keys are manifest uri, items are lists of annotations.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="geniza.annotations.models.annotations_to_list">
<span class="sig-prename descclassname"><span class="pre">geniza.annotations.models.</span></span><span class="sig-name descname"><span class="pre">annotations_to_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">annotations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uri</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geniza/annotations/models.html#annotations_to_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geniza.annotations.models.annotations_to_list" title="Link to this definition">¶</a></dt>
<dd><p>Generate an AnnotationList from a list of annotations.
Must specify the uri for the annotation list id.
Returns a dict that can be serialized as JSON.</p>
</dd></dl>

</section>
<section id="module-geniza.annotations.views">
<span id="views"></span><h2>views<a class="headerlink" href="#module-geniza.annotations.views" title="Link to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="geniza.annotations.views.AnnotationDetail">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">geniza.annotations.views.</span></span><span class="sig-name descname"><span class="pre">AnnotationDetail</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geniza/annotations/views.html#AnnotationDetail"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geniza.annotations.views.AnnotationDetail" title="Link to this definition">¶</a></dt>
<dd><p>View to read, update, or delete a single annotation.</p>
<dl class="py method">
<dt class="sig sig-object py" id="geniza.annotations.views.AnnotationDetail.delete">
<span class="sig-name descname"><span class="pre">delete</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geniza/annotations/views.html#AnnotationDetail.delete"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geniza.annotations.views.AnnotationDetail.delete" title="Link to this definition">¶</a></dt>
<dd><p>delete the annotation on DELETE</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geniza.annotations.views.AnnotationDetail.dispatch">
<span class="sig-name descname"><span class="pre">dispatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geniza/annotations/views.html#AnnotationDetail.dispatch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geniza.annotations.views.AnnotationDetail.dispatch" title="Link to this definition">¶</a></dt>
<dd><p>Wrap the dispatch method to add ETag/last modified headers when
appropriate, then return a conditional response.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geniza.annotations.views.AnnotationDetail.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geniza/annotations/views.html#AnnotationDetail.get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geniza.annotations.views.AnnotationDetail.get" title="Link to this definition">¶</a></dt>
<dd><p>display as annotation</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geniza.annotations.views.AnnotationDetail.get_etag">
<span class="sig-name descname"><span class="pre">get_etag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geniza/annotations/views.html#AnnotationDetail.get_etag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geniza.annotations.views.AnnotationDetail.get_etag" title="Link to this definition">¶</a></dt>
<dd><p>Get etag from annotation</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geniza.annotations.views.AnnotationDetail.get_last_modified">
<span class="sig-name descname"><span class="pre">get_last_modified</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geniza/annotations/views.html#AnnotationDetail.get_last_modified"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geniza.annotations.views.AnnotationDetail.get_last_modified" title="Link to this definition">¶</a></dt>
<dd><p>Return last modified <a class="reference external" href="https://docs.python.org/3/library/datetime.html#datetime.datetime" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">datetime.datetime</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geniza.annotations.views.AnnotationDetail.get_permission_required">
<span class="sig-name descname"><span class="pre">get_permission_required</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geniza/annotations/views.html#AnnotationDetail.get_permission_required"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geniza.annotations.views.AnnotationDetail.get_permission_required" title="Link to this definition">¶</a></dt>
<dd><p>return permission required based on request method</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geniza.annotations.views.AnnotationDetail.model">
<span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#geniza.annotations.views.AnnotationDetail.model" title="Link to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#geniza.annotations.models.Annotation" title="geniza.annotations.models.Annotation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotation</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geniza.annotations.views.AnnotationDetail.post">
<span class="sig-name descname"><span class="pre">post</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geniza/annotations/views.html#AnnotationDetail.post"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geniza.annotations.views.AnnotationDetail.post" title="Link to this definition">¶</a></dt>
<dd><p>update the annotation on POST</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="geniza.annotations.views.AnnotationList">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">geniza.annotations.views.</span></span><span class="sig-name descname"><span class="pre">AnnotationList</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geniza/annotations/views.html#AnnotationList"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geniza.annotations.views.AnnotationList" title="Link to this definition">¶</a></dt>
<dd><p>Base annotation endpoint; on GET, returns an annotation collection;
on POST with valid credentials and permissions, creates a new annotation.</p>
<dl class="py method">
<dt class="sig sig-object py" id="geniza.annotations.views.AnnotationList.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geniza/annotations/views.html#AnnotationList.get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geniza.annotations.views.AnnotationList.get" title="Link to this definition">¶</a></dt>
<dd><p>generate annotation collection response on GET request</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geniza.annotations.views.AnnotationList.get_permission_required">
<span class="sig-name descname"><span class="pre">get_permission_required</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geniza/annotations/views.html#AnnotationList.get_permission_required"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geniza.annotations.views.AnnotationList.get_permission_required" title="Link to this definition">¶</a></dt>
<dd><p>return permission required based on request method</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geniza.annotations.views.AnnotationList.model">
<span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#geniza.annotations.views.AnnotationList.model" title="Link to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#geniza.annotations.models.Annotation" title="geniza.annotations.models.Annotation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotation</span></code></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="geniza.annotations.views.AnnotationList.post">
<span class="sig-name descname"><span class="pre">post</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geniza/annotations/views.html#AnnotationList.post"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geniza.annotations.views.AnnotationList.post" title="Link to this definition">¶</a></dt>
<dd><p>“Create a new annotation</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="geniza.annotations.views.AnnotationResponse">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">geniza.annotations.views.</span></span><span class="sig-name descname"><span class="pre">AnnotationResponse</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geniza/annotations/views.html#AnnotationResponse"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geniza.annotations.views.AnnotationResponse" title="Link to this definition">¶</a></dt>
<dd><p>Base class for annotation responses; extends json response to set
annotation profile content type.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="geniza.annotations.views.AnnotationSearch">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">geniza.annotations.views.</span></span><span class="sig-name descname"><span class="pre">AnnotationSearch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geniza/annotations/views.html#AnnotationSearch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geniza.annotations.views.AnnotationSearch" title="Link to this definition">¶</a></dt>
<dd><p>Simple seach endpoint based on IIIF Search API.
Returns an annotation list response.</p>
<dl class="py method">
<dt class="sig sig-object py" id="geniza.annotations.views.AnnotationSearch.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geniza/annotations/views.html#AnnotationSearch.get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geniza.annotations.views.AnnotationSearch.get" title="Link to this definition">¶</a></dt>
<dd><p>Search annotations and return an annotation list. Currently only supports
search by target uri and source uri.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="geniza.annotations.views.AnnotationSearch.model">
<span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#geniza.annotations.views.AnnotationSearch.model" title="Link to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#geniza.annotations.models.Annotation" title="geniza.annotations.models.Annotation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Annotation</span></code></a></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="geniza.annotations.views.ApiAccessMixin">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">geniza.annotations.views.</span></span><span class="sig-name descname"><span class="pre">ApiAccessMixin</span></span><a class="reference internal" href="../_modules/geniza/annotations/views.html#ApiAccessMixin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geniza.annotations.views.ApiAccessMixin" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="geniza.annotations.views.parse_annotation_data">
<span class="sig-prename descclassname"><span class="pre">geniza.annotations.views.</span></span><span class="sig-name descname"><span class="pre">parse_annotation_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/geniza/annotations/views.html#parse_annotation_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#geniza.annotations.views.parse_annotation_data" title="Link to this definition">¶</a></dt>
<dd><p>For annotation create and update methods, parse json data from request in order
to set/update associated footnote. Returns content dict and footnote object.</p>
</dd></dl>

</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">Princeton Geniza Project</a></h1>



<p class="blurb">Django web application and other code for Princeton Geniza Project v4.x</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=Princeton-CDH&repo=geniza&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>







    

<p>
<a class="badge" href="https://codecov.io/github/Princeton-CDH/geniza">
    <img
    alt="https://codecov.io/github/Princeton-CDH/geniza/coverage.svg?branch=master"
    src="https://codecov.io/github/Princeton-CDH/geniza/coverage.svg?branch=master"
    />
</a>
</p>
<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../architecture.html">Architecture</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Code Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devnotes.html">Developer Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Change Log</a></li>
</ul>


  <div>
    <h3><a href="../index.html">Table of Contents</a></h3>
    <ul>
<li><a class="reference internal" href="#">Annotations</a><ul>
<li><a class="reference internal" href="#module-geniza.annotations.models">models</a><ul>
<li><a class="reference internal" href="#geniza.annotations.models.Annotation"><code class="docutils literal notranslate"><span class="pre">Annotation</span></code></a><ul>
<li><a class="reference internal" href="#geniza.annotations.models.Annotation.DoesNotExist"><code class="docutils literal notranslate"><span class="pre">Annotation.DoesNotExist</span></code></a></li>
<li><a class="reference internal" href="#geniza.annotations.models.Annotation.MultipleObjectsReturned"><code class="docutils literal notranslate"><span class="pre">Annotation.MultipleObjectsReturned</span></code></a></li>
<li><a class="reference internal" href="#geniza.annotations.models.Annotation.block"><code class="docutils literal notranslate"><span class="pre">Annotation.block</span></code></a></li>
<li><a class="reference internal" href="#geniza.annotations.models.Annotation.block_content_html"><code class="docutils literal notranslate"><span class="pre">Annotation.block_content_html</span></code></a></li>
<li><a class="reference internal" href="#geniza.annotations.models.Annotation.body_content"><code class="docutils literal notranslate"><span class="pre">Annotation.body_content</span></code></a></li>
<li><a class="reference internal" href="#geniza.annotations.models.Annotation.canonical"><code class="docutils literal notranslate"><span class="pre">Annotation.canonical</span></code></a></li>
<li><a class="reference internal" href="#geniza.annotations.models.Annotation.compile"><code class="docutils literal notranslate"><span class="pre">Annotation.compile()</span></code></a></li>
<li><a class="reference internal" href="#geniza.annotations.models.Annotation.content"><code class="docutils literal notranslate"><span class="pre">Annotation.content</span></code></a></li>
<li><a class="reference internal" href="#geniza.annotations.models.Annotation.created"><code class="docutils literal notranslate"><span class="pre">Annotation.created</span></code></a></li>
<li><a class="reference internal" href="#geniza.annotations.models.Annotation.etag"><code class="docutils literal notranslate"><span class="pre">Annotation.etag</span></code></a></li>
<li><a class="reference internal" href="#geniza.annotations.models.Annotation.footnote"><code class="docutils literal notranslate"><span class="pre">Annotation.footnote</span></code></a></li>
<li><a class="reference internal" href="#geniza.annotations.models.Annotation.get_absolute_url"><code class="docutils literal notranslate"><span class="pre">Annotation.get_absolute_url()</span></code></a></li>
<li><a class="reference internal" href="#geniza.annotations.models.Annotation.has_lines"><code class="docutils literal notranslate"><span class="pre">Annotation.has_lines</span></code></a></li>
<li><a class="reference internal" href="#geniza.annotations.models.Annotation.id"><code class="docutils literal notranslate"><span class="pre">Annotation.id</span></code></a></li>
<li><a class="reference internal" href="#geniza.annotations.models.Annotation.label"><code class="docutils literal notranslate"><span class="pre">Annotation.label</span></code></a></li>
<li><a class="reference internal" href="#geniza.annotations.models.Annotation.modified"><code class="docutils literal notranslate"><span class="pre">Annotation.modified</span></code></a></li>
<li><a class="reference internal" href="#geniza.annotations.models.Annotation.sanitize_html"><code class="docutils literal notranslate"><span class="pre">Annotation.sanitize_html()</span></code></a></li>
<li><a class="reference internal" href="#geniza.annotations.models.Annotation.set_content"><code class="docutils literal notranslate"><span class="pre">Annotation.set_content()</span></code></a></li>
<li><a class="reference internal" href="#geniza.annotations.models.Annotation.target_source_id"><code class="docutils literal notranslate"><span class="pre">Annotation.target_source_id</span></code></a></li>
<li><a class="reference internal" href="#geniza.annotations.models.Annotation.target_source_manifest_id"><code class="docutils literal notranslate"><span class="pre">Annotation.target_source_manifest_id</span></code></a></li>
<li><a class="reference internal" href="#geniza.annotations.models.Annotation.uri"><code class="docutils literal notranslate"><span class="pre">Annotation.uri()</span></code></a></li>
<li><a class="reference internal" href="#geniza.annotations.models.Annotation.via"><code class="docutils literal notranslate"><span class="pre">Annotation.via</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#geniza.annotations.models.AnnotationQuerySet"><code class="docutils literal notranslate"><span class="pre">AnnotationQuerySet</span></code></a><ul>
<li><a class="reference internal" href="#geniza.annotations.models.AnnotationQuerySet.by_target_context"><code class="docutils literal notranslate"><span class="pre">AnnotationQuerySet.by_target_context()</span></code></a></li>
<li><a class="reference internal" href="#geniza.annotations.models.AnnotationQuerySet.group_by_canvas"><code class="docutils literal notranslate"><span class="pre">AnnotationQuerySet.group_by_canvas()</span></code></a></li>
<li><a class="reference internal" href="#geniza.annotations.models.AnnotationQuerySet.group_by_manifest"><code class="docutils literal notranslate"><span class="pre">AnnotationQuerySet.group_by_manifest()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#geniza.annotations.models.annotations_to_list"><code class="docutils literal notranslate"><span class="pre">annotations_to_list()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-geniza.annotations.views">views</a><ul>
<li><a class="reference internal" href="#geniza.annotations.views.AnnotationDetail"><code class="docutils literal notranslate"><span class="pre">AnnotationDetail</span></code></a><ul>
<li><a class="reference internal" href="#geniza.annotations.views.AnnotationDetail.delete"><code class="docutils literal notranslate"><span class="pre">AnnotationDetail.delete()</span></code></a></li>
<li><a class="reference internal" href="#geniza.annotations.views.AnnotationDetail.dispatch"><code class="docutils literal notranslate"><span class="pre">AnnotationDetail.dispatch()</span></code></a></li>
<li><a class="reference internal" href="#geniza.annotations.views.AnnotationDetail.get"><code class="docutils literal notranslate"><span class="pre">AnnotationDetail.get()</span></code></a></li>
<li><a class="reference internal" href="#geniza.annotations.views.AnnotationDetail.get_etag"><code class="docutils literal notranslate"><span class="pre">AnnotationDetail.get_etag()</span></code></a></li>
<li><a class="reference internal" href="#geniza.annotations.views.AnnotationDetail.get_last_modified"><code class="docutils literal notranslate"><span class="pre">AnnotationDetail.get_last_modified()</span></code></a></li>
<li><a class="reference internal" href="#geniza.annotations.views.AnnotationDetail.get_permission_required"><code class="docutils literal notranslate"><span class="pre">AnnotationDetail.get_permission_required()</span></code></a></li>
<li><a class="reference internal" href="#geniza.annotations.views.AnnotationDetail.model"><code class="docutils literal notranslate"><span class="pre">AnnotationDetail.model</span></code></a></li>
<li><a class="reference internal" href="#geniza.annotations.views.AnnotationDetail.post"><code class="docutils literal notranslate"><span class="pre">AnnotationDetail.post()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#geniza.annotations.views.AnnotationList"><code class="docutils literal notranslate"><span class="pre">AnnotationList</span></code></a><ul>
<li><a class="reference internal" href="#geniza.annotations.views.AnnotationList.get"><code class="docutils literal notranslate"><span class="pre">AnnotationList.get()</span></code></a></li>
<li><a class="reference internal" href="#geniza.annotations.views.AnnotationList.get_permission_required"><code class="docutils literal notranslate"><span class="pre">AnnotationList.get_permission_required()</span></code></a></li>
<li><a class="reference internal" href="#geniza.annotations.views.AnnotationList.model"><code class="docutils literal notranslate"><span class="pre">AnnotationList.model</span></code></a></li>
<li><a class="reference internal" href="#geniza.annotations.views.AnnotationList.post"><code class="docutils literal notranslate"><span class="pre">AnnotationList.post()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#geniza.annotations.views.AnnotationResponse"><code class="docutils literal notranslate"><span class="pre">AnnotationResponse</span></code></a></li>
<li><a class="reference internal" href="#geniza.annotations.views.AnnotationSearch"><code class="docutils literal notranslate"><span class="pre">AnnotationSearch</span></code></a><ul>
<li><a class="reference internal" href="#geniza.annotations.views.AnnotationSearch.get"><code class="docutils literal notranslate"><span class="pre">AnnotationSearch.get()</span></code></a></li>
<li><a class="reference internal" href="#geniza.annotations.views.AnnotationSearch.model"><code class="docutils literal notranslate"><span class="pre">AnnotationSearch.model</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#geniza.annotations.views.ApiAccessMixin"><code class="docutils literal notranslate"><span class="pre">ApiAccessMixin</span></code></a></li>
<li><a class="reference internal" href="#geniza.annotations.views.parse_annotation_data"><code class="docutils literal notranslate"><span class="pre">parse_annotation_data()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

  </div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><div class="powered_by">
    <p>Powered by:</p>
    <a href="http://cdh.princeton.edu/">
        <img src="https://cdh.princeton.edu/static/img/CDH_logo.svg"
            alt="Center for Digital Humanities @ Princeton" />
    </a>
</div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2022, Center for Digital Humanities @ Princeton.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.4.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="../_sources/codedocs/annotations.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>