from django.db import models


class Library(models.Model):
    '''Library or archive that holds Geniza fragments'''
    name = models.CharField(max_length=255, unique=True)
    abbrev = models.CharField('Abbreviation', max_length=255, unique=True)
    url = models.URLField('URL', blank=True)

    class Meta:
        verbose_name_plural = 'Libraries'
        ordering = ['name']

    def __str__(self):
        return self.name

class LanguageScript(models.Model):
    '''Combination language and script'''
    language = models.CharField(max_length=255)
    script = models.CharField(max_length=255)
    display_name = models.CharField(max_length=255, blank=True, unique=True, null=True, 
        help_text="Option to override the autogenerated language-script name")

    class Meta:
        ordering = ['language']
        constraints = [models.UniqueConstraint(fields=['language', 'script'], name='unique_language_script')]

    def __str__(self):
        # Allow display_name to override autogenerated string
        # otherwise combine language and script
        #   e.g. Judaeo-Arabic (Hebrew script)
        return self.display_name or f"{self.language} ({self.script} script)"
