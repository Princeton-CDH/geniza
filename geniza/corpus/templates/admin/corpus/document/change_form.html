{% extends "admin/change_form.html" %}
{% block after_field_sets %}
    {% if original.pk %} {# don't display record history when adding new document #}
        <fieldset class="module aligned">
            <div class="form-row">
                <div class="fieldBox">
                    <label>Initial entry</label>
                    {% include "admin/corpus/document/log_entry.html" with log_entry=original.log_entries.last %}
                    <a href="{% url "admin:corpus_document_history" object_id=original.pk %}">view full history</a>
                </div>
            </div>
            <div class="form-row">
                <div class="fieldBox">
                    <label>Latest revision</label>
                    {% include "admin/corpus/document/log_entry.html" with log_entry=original.log_entries.first %}
                </div>
            </div>
        </fieldset>
    {% endif %}
    {% if original.has_transcription %}
        <fieldset class="module aligned transcriptions-field">
            <div class="form-row">
                <label>Transcription(s)</label>
                {% regroup original.footnotes.all by source as source_list %}
                {% for source in source_list %}
                    {% if source_list|length > 1 %}<h3 class="source">{{ source.grouper|safe }}</h3>{% endif %}
                    {% for footnote in source.list %}
                        {% if footnote.content %}
                            {% include "footnotes/transcription.html" with transcription=footnote.content %}
                        {% else %}
                            <div class="transcription">No transcription</div>
                        {% endif %}
                    {% endfor %}
                {% endfor %}
            </div>
        </fieldset>
    {% endif %}
{% endblock %}
