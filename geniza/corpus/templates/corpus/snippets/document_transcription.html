{% load i18n corpus_extras %}
<section id="transcription-panel">
    {# NOTE: inputs must be kept as SIBLINGS of panel-container for CSS selection/controls #}
    {# images displayed by default; disable if no images are available #}
    <input type="checkbox" id="images-on"  {% if document.has_image %}checked="true" {% else %} disabled="true"{% endif %}/><label for="images-on">show images</label>
    {# transcription displayed by default; disable if no content is available #}
    <input type="checkbox" id="transcription-on" {% if document.digital_editions %}checked="true" {% else %} disabled="true"{% endif %}><label for="transcription-on">show transcription</label>
    {# translation disabled for now since we don't handle them in the system yet #}
    <input type="checkbox" id="translation-on" disabled="true"/><label for="translation-on">show translation</label>
    <div class="panel-container">
        {% for image_info in document.iiif_images %}
            <div class="img">
                <h3>{{ image_info.label }}</h3> {# shelfmark not available yet #}
                <img src="{{ image_info.image|iiif_image:"size:width=500" }}" alt="{{ image_info.label }}" title="{{ image_info.label }}" loading="lazy"
                    sizes="(max-width: 650px) 50vw, 94vw"
                    srcset="{{ image_info.image|iiif_image:"size:width=300" }} 300w,
                    {{ image_info.image|iiif_image:"size:width=500" }} 500w,
                    {{ image_info.image|iiif_image:"size:width=600" }} 600w,
                    {{ image_info.image|iiif_image:"size:width=1000" }} 1000w">
            </div>
            <div class="transcription">
                {% if forloop.first %}<h3>Transcription</h3>{% endif %}
                {# display first transcription as single block for now #}
                {% if forloop.first %}
                    <div>{{ document.digital_editions.0.content.html|h1_to_h3|safe }}</div>
                {% endif %}
            </div>
        {% endfor %}
    </div>

</section>

{% comment %}
<hr/>
OLD panel


<section id="iiif-viewer" data-controller="iiif">
    <h1 class="sr-only">
        {# Translators: accessibility label for document images and transcription section #}
        {% translate "Images and transcription" %}
    </h1>
    {% if document.has_image %}
        <noscript>
            <ol id="iiif-images-fallback">
                {% for image_dict in document.iiif_images %}
                    <li id="image-{{ forloop.counter }}">
                        <a href="{{ image_dict.image|iiif_image:"size:width=2880" }}">
                            <img src="{{ image_dict.image|iiif_image:"size:width=500" }}" alt="{{ image_dict.label }}" title="{{ image_dict.label }}" loading="lazy">
                        </a>
                    </li>
                {% endfor %}
            </ol>
        </noscript>
        <div id="iiif-images" data-iiif-target="iiifContainer" data-iiif-urls="{{ document.iiif_images|iiif_info_json }}" class="{% if not document.has_transcription %}no-transcription{% endif %}">
        </div>
    {% endif %}
    {% if document.digital_editions %}
        <div class="transcription{% if not document.has_image %} no-image{% endif %}">
            <h2>{% translate 'Transcription' %}</h2>
            {% if document.digital_editions|length > 1 %}
                {# when there are multiple editions, use disclosure element #}
                {% for edition in document.digital_editions %}
                    <details open>
                        <summary class="source">{{ edition.source.display }}</summary>
                        <div>{{ edition.content.html|h1_to_h3|safe }}</div>
                    </details>
                {% endfor %}
            {% else %}
                <div>{{ document.digital_editions.0.content.html|h1_to_h3|safe }}</div>
            {% endif %}
        </div>
    {% endif %}
    {% if document.has_image %}
        {% include "corpus/snippets/document_image_rights.html" %}
    {% endif %}
</section>
{% endcomment %}
