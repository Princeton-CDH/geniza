<script src="https://unpkg.com/mirador@latest/dist/mirador.min.js"></script>

<div style="max-width: 500px; margin: 10px auto;">

    <h1>PGPID: {{ document.id }}</h1>

    <div><dt>Shelfmark:</dt> <dd>{{ document.shelfmark }}</dd></div>

    {% if document.doctype %}
    <div><dt>Document Type:</dt> <dd>{{ document.doctype }}</dd></div>
    {% endif %}
    
    <div><dt>First input:</dt> <dd>{{ document.log_entries.last.action_time.year }}</dd></div>

    <div><dt>Tags:</dt> 
        {% for tag in document.tags.all %}
            <dd>#{{ tag }}</dd>
        {% endfor %}
    </div>

    <p>{{ document.description }}</p>

    {% for fragment in document.fragments.all %}
    <div>
        {% if fragment.iiif_url %}
            <div class="wrapper">
                <div id="iiif_viewer" class="image-viewer" style="position: relative; height:375px;"></div>
                <script type="text/javascript">
                  Mirador.viewer({
                    id: "iiif_viewer",
                    window: {
                      allowClose: false, // Prevent the user from closing this window
                      allowMaximize: false,
                      defaultSideBarPanel: 'info',
                      sideBarOpenByDefault: false,
                      views: [ // Only allow the user to select single and gallery view
                        { key: 'single' },
                        { key: 'gallery' },
                      ],
                    defaultView: 'single',
                    },
                    galleryView: {
                        height: 250
                    },
                    thumbnailNavigation: {
                        defaultPosition: 'far-right'
                    },
                    windows: [{
                        loadedManifest: '{{ fragment.iiif_url }}',
                    }],
                    workspaceControlPanel: {
                        enabled: false, // Remove extra workspace settings,
                    }
                  });
                </script>
            </div>
        {% endif %}
    </div>
    {% endfor %}

    

</div>
