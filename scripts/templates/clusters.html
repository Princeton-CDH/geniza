{% extends "base.html" %}

{% block title %}Geniza Prototype | New Search {% endblock %}

{% block head %}
 {{ super() }}
    <style>
        /*input[type=text] {font-size: 16pt; width: 90%;}*/
        /* style highlights tagged by Solr */
        em {
            color: #357edd;
            font-style: normal;
        }

        .transcription {
            direction: rtl;  /* assuming all for now */
            text-align: right;
            white-space: pre;
        }

        ol ::marker {
            font-weight: bold;
        }
    </style>
{% endblock %}

{% block content %}
{# two columns #}
<div class="mw9 center ph3-ns">
  <div class="cf ph2-ns">
    <div class="fl w-100 w-40-ns pa2">
        {% set form_url = "/clusters/" %}
        {% include 'search_form.html' %}

    {% if not search_term %}
    <h2>Clusters</h2>
    <p>Sorted by size</p>
    {% else %}
    <div class="fl w-80 pa2">Total results {{ total }} document{% if total != 1 %}s{% endif %}</div>
    <div class="fl w-20 pa2 b">sorted by relevance</div>
    {% endif %}

    {% if not search_term %}
    <ol>
        {% for cluster in clusters %}
        <li class="pl1 pb2"><a class="dib no-underline dim black v-mid" href="?cluster={{ cluster.value }}">
            <div class="f3 lh-copy {% if cluster.selected %}blue{% endif %}">{{ cluster.label }}</div>
            {{ cluster.count }} Documents
            </a>
        </li>
        {% endfor %}
    </ol>
    </div> {# end first column #}
    {% endif %}

    {% if documents %}
        {% if not search_term %}
        {# second column, when there are documents but no search term #}
        <div class="fl w-100 w-60-ns pa2">
          <div class="bl-ns bt bt-0-ns pv4">
            <div class="pl3">
                <div class="f2 lh-copy blue">{{ current_cluster }}</div>
                <div>{{ current_cluster_count }} Documents</div>
            </div>
        {% endif %}

          <ol>
          {% for doc in documents %}
              <li class="pb3">
                {# show the first document, with tags #}
                {% set show_tags = true %}
                {% include "cluster_result.html" %}
                {# if there is more than one document in this group, show all others without tags #}
                {% if doc.tagset_s in groups %}
                {% for group_doc in groups[doc.tagset_s]['docs'] %}
                    {# don't repeat tags, since they are the same for theg roup #}
                    {% set show_tags = false %}
                     {% include "cluster_result.html" %}
                {% endfor %}
                {% endif %}

              </li>
          {% endfor %}
          </ol>
      </div>

    </div>
  {% endif %}
  </div>

</div>

{% endblock %}
