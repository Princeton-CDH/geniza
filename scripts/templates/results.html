{% extends "base.html" %}

{% block title %}Geniza Search Prototype | Search results for {{ search_term }} | {% endblock %}

{% block head %}
 {{ super() }}
    <style>
        /*input[type=text] {font-size: 16pt; width: 90%;}*/
        /* style highlights tagged by Solr */
        em {background-color: #3DFF6A; font-weight: bold; font-style: normal; }

        .transcription {
            direction: rtl;  /* assuming all for now */
            text-align: right;
            white-space: pre;
        }
    </style>
{% endblock %}

{% block content %}
    {% include 'search_form.html' %}

    <p class="fr w-100 w-20-ns ma0">Showing {{ results|length }} of {{ total }} result{% if total > 1 %}s{% endif %}</p>
    {% if results|length > 0 %}
    <ul class="mw9 ml0 pl0 center ph3-ns list">
        <li class="f5 lh-copy cf ph2-ns serif fw6 pl0 avenir">
            <div class="fl w-20 w-10-ns pa2 b tr avenir b">
                PGP ID
                <div class="pt0">Type</div>
            </div>
            <div class="fl w-80 w-10-ns pa2 b avenir">Description</div>
        </li>
        {% for result in results %}
        <li class="cf ph2-ns pl0" data-id="{{ result.id }}">
            <div class="fl w-20 w-10-ns pa2 b tr avenir fw5">
                {{ result.id }}
                <div class="pt2">
                {{ result.type_s}}
                </div>
            </div>
            <div class="fl w-80 pa2">
                <div>{{ result.description_txt[0]|safe }}</div>
                {% if result.editors_txt %}<div><span class="mid-gray">Editor:</span> {{ result.editors_txt[0] }}</div>{% endif %}
                {% if result.translators_txt %}<div><span class="mid-gray">Translator:</span> {{ result.translators_txt[0] }}</div>{% endif %}
                {% if result.transcription_highlights %}<div class="pt2 transcription">{% for line in result.transcription_highlights %}{% if line %}<div class="pa0">{{ line|safe }}</div>{% endif %}{% endfor %}</div>{% endif %}
                <div class="w-100 flex justify-between pt2">
                    <!-- source mss -->
                    <div class="id fl purple avenir">{{ result.shelfmark_s }} | {{ result.library_s }}</div><br>
                    <!-- View external source -->
                    {% if result.link_s %}
                    <div><a class="id fl purple avenir" href="{{ result.link_s }}">View external record</a></div>
                    {% endif %}
                </div>
                <div class="w-100 pt2 flex justify-between items-right">
                    <div>
                        <ul class="list pl0 dark-gray">
                        {% for tag in result.tags_ss %}
                         <li class="di">#{{ tag }}</li>
                        {% endfor %}
                        </ul>
                    </div>
                    <!-- View external source -->
                    <!-- score + relevance bar -->
                    {% if result.score %}
                    <div class="fr w-20-ns">
                        <!-- relevance bar -->
                        <div class="ba w-25-ns w-30 h1 fr ma1">
                            <div class="bg-light-blue h-100 mw-100" style="width:{{ result.score / 100 * 100 }}%">
                            </div>
                        </div>
                        <span class="score light-silver fr pa1">{{ result.score }}</span>
                    </div>
                    {% endif %}
                </div>


            </div>
        </li>
        {% endfor %}
    </ul>
    {% endif %}
{% endblock %}
